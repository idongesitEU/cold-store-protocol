const fs=require("node:fs"),crypto=require("crypto"),wordlists={"bip-39-word-list":readTextFile("bip-39-word-list.txt").split(" ")};if(2048!==wordlists["bip-39-word-list"].length)throw"bip39 wordlist corrupt!";const WORD_LIST=wordlists["bip-39-word-list"];function sha256(e,t="sha256"){const r=crypto.createHash(t);return r.update(e),r.digest("hex")}function sha256NTimes(e,t){if(!e||!t)throw"missing arguements";for(let r=0;r<t;r++)e=sha256(e);return e}function sha256Base64(e){const t=crypto.createHash("sha256");return t.update(e),t.digest("base64")}function sha256Base64NTimes(e,t){if(!e||!t)throw"missing arguements";for(let r=0;r<t;r++)e=sha256Base64(e);return e}function validateInput(e,t){if(sha256(e)!=t)throw"invalid input!!, hash does not match"}function isString(e,t){if(t=t||"input","string"!=typeof e)throw`input is not a string, ${t} must be string`;return!0}function isInteger(e,t,r=!0){if(t=t||"input",e.toString().match(/^[0-9]+$/gm)&&e.toString()!==e)return!0;if(r)throw`${t} is not an integer, ${t} must be integer`;return!1}function readTextFile(e){try{return fs.readFileSync(e,"utf8")}catch(t){throw console.error("Error reading the file:",e,t),"terminated at readFile"}}function isValidPhrase(e,t){const r=e.match(/^([A-Za-z]+\s)+[A-Za-z]+$/gm);if(t&&!r)throw"invalid phrase";return!!r}function pseudoRandomChecksumWord(e){isValidPhrase(e,!0),isString(e);const t=pseudoRandomNumber(e),r=Math.round(t*WORD_LIST.length);return WORD_LIST[r]}function pseudoRandomNumber(e){isString(e);return divideHexAsBase10(sha256(e),"f".repeat(64))}function convertBase(e,t,r){const n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ+/",add=(e,t,r)=>{let n=[];const s=Math.max(e.length,t.length);let a=0,i=0;for(;i<s||a;){const s=a+(i<e.length?e[i]:0)+(i<t.length?t[i]:0);n.push(s%r),a=Math.floor(s/r),i++}return n},multiplyByNumber=(e,t,r)=>{if(e<0)return null;if(0==e)return[];let n=[],s=t;for(;1&e&&(n=add(n,s,r)),0!=(e>>=1);)s=add(s,s,r);return n},s=((e,t)=>{const r=e.split("");let s=[];for(let e=r.length-1;e>=0;e--){const t=n.indexOf(r[e]);if(-1==t)return null;s.push(t)}return s})(e);if(null===s)return null;let a=[],i=[1];for(let e=0;e<s.length;e++)s[e]&&(a=add(a,multiplyByNumber(s[e],i,r),r)),i=multiplyByNumber(t,i,r);let o="";for(let e=a.length-1;e>=0;e--)o+=n[a[e]];return o}function pseudoRandomInteger(e){return convertBase(sha256(e),16,10)}function getWord(e){if(isInteger(e),e>=1&&e<=WORD_LIST.length)return WORD_LIST[e-1];throw"word number must be greater than 1 and less than the length of the word list "}function divideHexAsBase10(e,t){return(e=parseInt(e,16))/(t=parseInt(t,16))}function getFirstN(e,t){if(isInteger(t,t),t>=1&&t<=e.length){let r="";for(let n=0;n<t;n++)r+=e[n];return r}throw"n must be greater than or equal to 1 and less than the string length"}function getLastN(e,t){if(isInteger(t,t),t>=1&&t<=e.length){let r=[];for(let n=e.length-1;n>e.length-t-1;n--)r.unshift(e[n]);return r.join("")}throw"n must be greater than or equal to 1 and less than the string length"}function stringToNJoinArray(e,t){if(isString(e,e),isInteger(t,t),e.length%t!=0)throw"string length must be divisible by n";const r=[];for(i=0;i<e.length;i+=t)r.push(e.substr(i,t));return r}function binaryArrayToBase10Array(e){return e.map((e=>parseInt(e,2)))}function ASCIICharsFromNumberArray(e){const t=[];for(let e=33;e<127;e++)t.push(String.fromCharCode(e));const r=t.length;let n="";e.map((e=>{n+=t[e%r]}));return n}function base64ToHex(e){const t=atob(e);let r="";for(let e=0;e<t.length;e++){const n=t.charCodeAt(e).toString(16);r+=2===n.length?n:"0"+n}return r.toLocaleLowerCase()}function hexToBinary(e){e=e.replace("0x","").toLowerCase();var t="";for(var r of e)switch(r){case"0":t+="0000";break;case"1":t+="0001";break;case"2":t+="0010";break;case"3":t+="0011";break;case"4":t+="0100";break;case"5":t+="0101";break;case"6":t+="0110";break;case"7":t+="0111";break;case"8":t+="1000";break;case"9":t+="1001";break;case"a":t+="1010";break;case"b":t+="1011";break;case"c":t+="1100";break;case"d":t+="1101";break;case"e":t+="1110";break;case"f":t+="1111";break;default:return""}return t}function hasInvalidASCIIChars(e){for(var t=!1,r=0;r<e.length;r++){if(e.charCodeAt(r)>127){t=!0;break}}return t}function getFileNameFromFolderUrl(e){return/.*?\/?([\w-]+)\.txt$/gm.exec(e)[1]}function saveFile(e,t){fs.writeFileSync(e,t),console.log(e,"saved successfully")}module.exports={WORD_LIST:WORD_LIST,sha256:sha256,sha256NTimes:sha256NTimes,sha256Base64:sha256Base64,sha256Base64NTimes:sha256Base64NTimes,validateInput:validateInput,isString:isString,isInteger:isInteger,readTextFile:readTextFile,pseudoRandomChecksumWord:pseudoRandomChecksumWord,pseudoRandomNumber:pseudoRandomNumber,pseudoRandomInteger:pseudoRandomInteger,getFirstN:getFirstN,getLastN:getLastN,stringToNJoinArray:stringToNJoinArray,binaryArrayToBase10Array:binaryArrayToBase10Array,ASCIICharsFromNumberArray:ASCIICharsFromNumberArray,base64ToHex:base64ToHex,hexToBinary:hexToBinary,hasInvalidASCIIChars:hasInvalidASCIIChars,getFileNameFromFolderUrl:getFileNameFromFolderUrl,saveFile:saveFile};
